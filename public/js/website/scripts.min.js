function watermarkEnter(e, o) {
    e.value == o && (e.value = "", e.style.color = "", e.select())
}

function watermarkLeave(e, o) {
    "" == e.value && (e.value = o)
}

function trackUserLocation(e) {}

function Get_Cookie(e) {
    var o = document.cookie.split(";"),
        t = "",
        i = "",
        n = !1,
        r = "";
    for (r = 0; r < o.length; r++) {
        if ((t = o[r].split("="))[0].replace(/^\s+|\s+$/g, "") == e) return n = !0, t.length > 1 && (i = unescape(t[1].replace(/^\s+|\s+$/g, ""))), i;
        t = null
    }
    if (!n) return null
}

function Set_Cookie(e, o, t, i, n, r) {
    var l = new Date;
    l.setTime(l.getTime()), t && (t = 1e3 * t * 60 * 60 * 24);
    var s = new Date(l.getTime() + t);
    document.cookie = e + "=" + escape(o) + (t ? ";expires=" + s.toGMTString() : "") + (i ? ";path=" + i : "") + (n ? ";domain=" + n : "") + (r ? ";secure" : "")
}

function Delete_Cookie(e, o, t) {
    Get_Cookie(e) && (document.cookie = e + "=" + (o ? ";path=" + o : "") + (t ? ";domain=" + t : "") + ";expires=Thu, 01-Jan-1970 00:00:01 GMT")
}
var exitThisPagePrompt = "Are you sure you want to leave this page?",
    alreadySetExitPrompt = !1,
    requireExitPrompt = !1,
    contentDidChange = !1;

function goodbye(e) {
    if (requireExitPrompt && contentDidChange) return exitThisPagePrompt
}

function hookupGoodbyePrompt(e) {
    contentDidChange = !0, !alreadySetExitPrompt && requireExitPrompt && (exitThisPagePrompt = e, alreadySetExitPrompt = !0, window.onbeforeunload = goodbye)
}

function unHookGoodbyePrompt() {
    requireExitPrompt = !1
}! function(e, o, t, i) {
    var n = e(o);
    e.fn.lazyload = function(t) {
        var r, l = this,
            s = {
                threshold: 0,
                failure_limit: 0,
                event: "scroll.lazyload",
                effect: "show",
                container: o,
                data_attribute: "original",
                data_srcset: "srcset",
                skip_invisible: !1,
                appear: null,
                load: null,
                placeholder: "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs="
            };

        function d() {
            var o = 0;
            l.each(function() {
                var t = e(this);
                if (!s.skip_invisible || t.is(":visible"))
                    if (e.abovethetop(this, s) || e.leftofbegin(this, s));
                    else if (e.belowthefold(this, s) || e.rightoffold(this, s)) {
                    if (++o > s.failure_limit) return !1
                } else t.trigger("appear"), o = 0
            })
        }
        return t && (i !== t.failurelimit && (t.failure_limit = t.failurelimit, delete t.failurelimit), i !== t.effectspeed && (t.effect_speed = t.effectspeed, delete t.effectspeed), e.extend(s, t)), r = s.container === i || s.container === o ? n : e(s.container), 0 === s.event.indexOf("scroll") && r.off(s.event).on(s.event, function() {
            return d()
        }), this.each(function() {
            var o = this,
                t = e(o);
            o.loaded = !1, t.attr("src") !== i && !1 !== t.attr("src") || t.is("img") && t.attr("src", s.placeholder), t.one("appear", function() {
                if (!this.loaded) {
                    if (s.appear) {
                        var i = l.length;
                        s.appear.call(o, i, s)
                    }
                    e("<img />").one("load", function() {
                        var i = t.attr("data-" + s.data_attribute),
                            n = t.attr("data-" + s.data_srcset);
                        i != t.attr("src") && (t.hide(), t.is("img") && (t.attr("src", i), null != n && t.attr("srcset", n)), t.is("video") && t.attr("poster", i), t[s.effect](s.effect_speed)), o.loaded = !0;
                        var r = e.grep(l, function(e) {
                            return !e.loaded
                        });
                        if (l = e(r), s.load) {
                            var d = l.length;
                            s.load.call(o, d, s)
                        }
                    }).attr({
                        src: t.attr("data-" + s.data_attribute),
                        srcset: t.attr("data-" + s.data_srcset) || ""
                    }).error(function() {
                        var e = t.attr("data-" + s.data_attribute);
                        e.search("bp.blogspot.com") > 0 && e.search("focus-opensocial.googleusercontent") <= 0 && (e = "https://images2-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&gadget=a&no_expand=1&resize_h=0&rewriteMime=image%2F*&url=" + encodeURIComponent(e), t.attr("src", e))
                    })
                }
            }), 0 !== s.event.indexOf("scroll") && t.off(s.event).on(s.event, function() {
                o.loaded || t.trigger("appear")
            })
        }), n.off("resize.lazyload").bind("resize.lazyload", function() {
            d()
        }), /(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion) && n.on("pageshow", function(o) {
            o.originalEvent && o.originalEvent.persisted && l.each(function() {
                e(this).trigger("appear")
            })
        }), e(function() {
            d()
        }), this
    }, e.belowthefold = function(t, r) {
        return (r.container === i || r.container === o ? (o.innerHeight ? o.innerHeight : n.height()) + n.scrollTop() : e(r.container).offset().top + e(r.container).height()) <= e(t).offset().top - r.threshold
    }, e.rightoffold = function(t, r) {
        return (r.container === i || r.container === o ? n.width() + n.scrollLeft() : e(r.container).offset().left + e(r.container).width()) <= e(t).offset().left - r.threshold
    }, e.abovethetop = function(t, r) {
        return (r.container === i || r.container === o ? n.scrollTop() : e(r.container).offset().top) >= e(t).offset().top + r.threshold + e(t).height()
    }, e.leftofbegin = function(t, r) {
        return (r.container === i || r.container === o ? n.scrollLeft() : e(r.container).offset().left) >= e(t).offset().left + r.threshold + e(t).width()
    }, e.inviewport = function(o, t) {
        return !(e.rightoffold(o, t) || e.leftofbegin(o, t) || e.belowthefold(o, t) || e.abovethetop(o, t))
    }, e.extend(e.expr[":"], {
        "below-the-fold": function(o) {
            return e.belowthefold(o, {
                threshold: 0
            })
        },
        "above-the-top": function(o) {
            return !e.belowthefold(o, {
                threshold: 0
            })
        },
        "right-of-screen": function(o) {
            return e.rightoffold(o, {
                threshold: 0
            })
        },
        "left-of-screen": function(o) {
            return !e.rightoffold(o, {
                threshold: 0
            })
        },
        "in-viewport": function(o) {
            return e.inviewport(o, {
                threshold: 0
            })
        },
        "above-the-fold": function(o) {
            return !e.belowthefold(o, {
                threshold: 0
            })
        },
        "right-of-fold": function(o) {
            return e.rightoffold(o, {
                threshold: 0
            })
        },
        "left-of-fold": function(o) {
            return !e.rightoffold(o, {
                threshold: 0
            })
        }
    })
}(jQuery, window, document),
function(e) {
    e.isScrollToFixed = function(o) {
        return !!e(o).data("ScrollToFixed")
    }, e.ScrollToFixed = function(o, t) {
        var i = this;
        i.$el = e(o), i.el = o, i.$el.data("ScrollToFixed", i);
        var n, r, l, s, d = !1,
            a = i.$el,
            f = 0,
            c = 0,
            p = -1,
            u = -1,
            h = null;

        function x() {
            var e = i.options.limit;
            return e ? "function" == typeof e ? e.apply(a) : e : 0
        }

        function g() {
            return "fixed" === n
        }

        function m() {
            return "absolute" === n
        }

        function b() {
            return !(g() || m())
        }

        function T() {
            if (!g()) {
                var e = a[0].getBoundingClientRect();
                h.css({
                    display: a.css("display"),
                    width: e.width,
                    height: e.height,
                    float: a.css("float")
                }), cssOptions = {
                    "z-index": i.options.zIndex,
                    position: "fixed",
                    top: -1 == i.options.bottom ? S() : "",
                    bottom: -1 == i.options.bottom ? "" : i.options.bottom,
                    "margin-left": "0px"
                }, i.options.dontSetWidth || (cssOptions.width = a.css("width")), a.css(cssOptions), a.addClass(i.options.baseClassName), i.options.className && a.addClass(i.options.className), n = "fixed"
            }
        }

        function F() {
            var e = x(),
                o = c;
            i.options.removeOffsets && (o = "", e -= f), cssOptions = {
                position: "absolute",
                top: e,
                left: o,
                "margin-left": "0px",
                bottom: ""
            }, i.options.dontSetWidth || (cssOptions.width = a.css("width")), a.css(cssOptions), n = "absolute"
        }

        function v() {
            b() || (u = -1, h.css("display", "none"), a.css({
                "z-index": s,
                width: "",
                position: r,
                left: "",
                top: l,
                "margin-left": ""
            }), a.removeClass("scroll-to-fixed-fixed"), i.options.className && a.removeClass(i.options.className), n = null)
        }

        function w(e) {
            e != u && (a.css("left", c - e), u = e)
        }

        function S() {
            var e = i.options.marginTop;
            return e ? "function" == typeof e ? e.apply(a) : e : 0
        }

        function A() {
            if (e.isScrollToFixed(a) && !a.is(":hidden")) {
                var o = d,
                    t = b();
                d ? b() && (f = a.offset().top, c = a.offset().left) : (a.trigger("preUnfixed.ScrollToFixed"), v(), a.trigger("unfixed.ScrollToFixed"), u = -1, f = a.offset().top, c = a.offset().left, i.options.offsets && (c += a.offset().left - a.position().left), -1 == p && (p = c), n = a.css("position"), d = !0, -1 != i.options.bottom && (a.trigger("preFixed.ScrollToFixed"), T(), a.trigger("fixed.ScrollToFixed")));
                var l = e(window).scrollLeft(),
                    s = e(window).scrollTop(),
                    h = x();
                i.options.minWidth && e(window).width() < i.options.minWidth ? b() && o || (y(), a.trigger("preUnfixed.ScrollToFixed"), v(), a.trigger("unfixed.ScrollToFixed")) : i.options.maxWidth && e(window).width() > i.options.maxWidth ? b() && o || (y(), a.trigger("preUnfixed.ScrollToFixed"), v(), a.trigger("unfixed.ScrollToFixed")) : -1 == i.options.bottom ? h > 0 && s >= h - S() ? t || m() && o || (y(), a.trigger("preAbsolute.ScrollToFixed"), F(), a.trigger("unfixed.ScrollToFixed")) : s >= f - S() ? (g() && o || (y(), a.trigger("preFixed.ScrollToFixed"), T(), u = -1, a.trigger("fixed.ScrollToFixed")), w(l)) : b() && o || (y(), a.trigger("preUnfixed.ScrollToFixed"), v(), a.trigger("unfixed.ScrollToFixed")) : h > 0 ? s + e(window).height() - a.outerHeight(!0) >= h - (S() || - function() {
                    if (!i.options.bottom) return 0;
                    return i.options.bottom
                }()) ? g() && (y(), a.trigger("preUnfixed.ScrollToFixed"), "absolute" === r ? F() : v(), a.trigger("unfixed.ScrollToFixed")) : (g() || (y(), a.trigger("preFixed.ScrollToFixed"), T()), w(l), a.trigger("fixed.ScrollToFixed")) : w(l)
            }
        }

        function y() {
            var e = a.css("position");
            "absolute" == e ? a.trigger("postAbsolute.ScrollToFixed") : "fixed" == e ? a.trigger("postFixed.ScrollToFixed") : a.trigger("postUnfixed.ScrollToFixed")
        }
        var C = function(e) {
                a.is(":visible") && (d = !1, A())
            },
            _ = function(e) {
                window.requestAnimationFrame ? requestAnimationFrame(A) : A()
            };
        i.init = function() {
            i.options = e.extend({}, e.ScrollToFixed.defaultOptions, t), s = a.css("z-index"), i.$el.css("z-index", i.options.zIndex), h = e("<div />"), n = a.css("position"), r = a.css("position"), a.css("float"), l = a.css("top"), b() && i.$el.after(h), e(window).bind("resize.ScrollToFixed", C), e(window).bind("scroll.ScrollToFixed", _), "ontouchmove" in window && e(window).bind("touchmove.ScrollToFixed", A), i.options.preFixed && a.bind("preFixed.ScrollToFixed", i.options.preFixed), i.options.postFixed && a.bind("postFixed.ScrollToFixed", i.options.postFixed), i.options.preUnfixed && a.bind("preUnfixed.ScrollToFixed", i.options.preUnfixed), i.options.postUnfixed && a.bind("postUnfixed.ScrollToFixed", i.options.postUnfixed), i.options.preAbsolute && a.bind("preAbsolute.ScrollToFixed", i.options.preAbsolute), i.options.postAbsolute && a.bind("postAbsolute.ScrollToFixed", i.options.postAbsolute), i.options.fixed && a.bind("fixed.ScrollToFixed", i.options.fixed), i.options.unfixed && a.bind("unfixed.ScrollToFixed", i.options.unfixed), i.options.spacerClass && h.addClass(i.options.spacerClass), a.bind("resize.ScrollToFixed", function() {
                h.height(a.height())
            }), a.bind("scroll.ScrollToFixed", function() {
                a.trigger("preUnfixed.ScrollToFixed"), v(), a.trigger("unfixed.ScrollToFixed"), A()
            }), a.bind("detach.ScrollToFixed", function(o) {
                ! function(e) {
                    (e = e || window.event).preventDefault && e.preventDefault(), e.returnValue = !1
                }(o), a.trigger("preUnfixed.ScrollToFixed"), v(), a.trigger("unfixed.ScrollToFixed"), e(window).unbind("resize.ScrollToFixed", C), e(window).unbind("scroll.ScrollToFixed", _), a.unbind(".ScrollToFixed"), h.remove(), i.$el.removeData("ScrollToFixed")
            }), C()
        }, i.init()
    }, e.ScrollToFixed.defaultOptions = {
        marginTop: 0,
        limit: 0,
        bottom: -1,
        zIndex: 1e3,
        baseClassName: "scroll-to-fixed-fixed"
    }, e.fn.scrollToFixed = function(o) {
        return this.each(function() {
            new e.ScrollToFixed(this, o)
        })
    }
}(jQuery);

function HideMenuToolbar() {
    $("#toolbar").fadeOut(), $("#toolbarbut").fadeIn("slow")
}

function ShowMenuToolbar() {
    $("#toolbar").fadeIn(), $("#toolbarbut").fadeOut("slow")
}

function SetReferrerPolicy(e) {
    var t = document.querySelector('meta[name="referrer"]');
    if (null != t) 1 == e ? t.setAttribute("content", "no-referrer") : t.setAttribute("content", "no-referrer-when-downgrade");
    else {
        var i = document.createElement("meta");
        i.name = "referrer", i.content = 1 == e ? "no-referrer" : "no-referrer-when-downgrade", document.getElementsByTagName("head")[0].appendChild(i)
    }
}

$("span.downarr a").click(function() {
    HideMenuToolbar(), Set_Cookie("openstate", "closed", 1, "/")
}), $("span.showbar a").click(function() {
    ShowMenuToolbar(), Set_Cookie("openstate", "open", 1, "/")
}), $("span.downarr a, span.showbar a").click(function() {
    return !1
});
var openState = Get_Cookie("openstate");
null != openState && ("closed" == openState && HideMenuToolbar(), "open" == openState && ShowMenuToolbar()), $("#back-to-top").hide(), $(function() {
    $(window).scroll(function() {
        $(this).scrollTop() > 100 ? $("#back-to-top").fadeIn() : $("#back-to-top").fadeOut()
    }), $("#back-to-top").click(function() {
        return $("body,html").animate({
            scrollTop: 0
        }, 800), !1
    })
});
var wWidth = window.innerWidth;

var isNoReferrer = !1,
    suggestTimeout = null;

function SuggestSearch(e, t) {
    0 == isNoReferrer && (SetReferrerPolicy(!0), isNoReferrer = !0);
    new Date;
    var i, a = $(e).parent().find(".suggestsearch ul");
    40 != t.which ? 38 != t.which ? 13 != t.which ? (clearTimeout(suggestTimeout), suggestTimeout = setTimeout(function() {
        var t = $(e).parent();
        $(t).find(".suggestsearch").length || $(t).append("<div class='suggestsearch'></div>");
        var i = $(t).find(".suggestsearch"),
            a = $(e).val().trim().toLowerCase();
        a.length < 1 ? $(i).hide() : a.length >= 1 && ($(e).addClass("loading"))
    }, 300)) : $(e).parent().find(".searchbutton").trigger("click") : 0 == $(a).find(".selected").length ? $(a).find("li").last().addClass("selected") : ((i = $(a).find(".selected").prev()).hasClass("li-group") && (i = i.prev()), $(a).find(".selected").removeClass("selected"), i.addClass("selected")) : 0 == $(a).find(".selected").length ? $(a).find("li").first().addClass("selected") : ((i = $(a).find(".selected").next()).hasClass("li-group") && (i = i.next()), $(a).find(".selected").removeClass("selected"), i.addClass("selected"))
}
$(".comicsearchbox input[type='text']").keyup(function(e) {
    SuggestSearch(this, e)
}), $(".comicsearchbox input[type='text']").focus(function() {
    wWidth < 768 ? $(".search-box").addClass("search-box-expanded") : $(".search-box").removeClass("search-box-expanded"), window.scrollTo(0, window.scrollY)
}).blur(function() {
    $(".search-box").removeClass("search-box-expanded")
}), $("html").click(function() {
    $(".suggestsearch").hide(), $(".notification-popup").remove()
});
var callInitFrom404 = !1;
if ($("body").hasClass("pagenotfound")) {
    $(".pagenotfound .searchbutton").click(function() {
        var e = $(this).parents(".comicsearchbox").find(".searchinput");
        return e.val().length && (location.href = "/tim-truyen?keyword=" + encodeURIComponent(e.val()).replace(/%20/g, "+")), !1
    }), $(".pagenotfound .comicsearchbox input[type='text']").keyup(function(e) {
        13 != e.which || $(".pagenotfound .comicsearchbox .searchbutton").trigger("click")
    });
    var path = window.location.pathname,
        pathTemp = "";
    if (path.startsWith("/truyen-tranh/") ? pathTemp = path.replace("/truyen-tranh/", "") : path.startsWith("/truyen/") && (pathTemp = path.replace("/truyen/", "")), "" != pathTemp) {
        var pathArray = pathTemp.split("/");
        pathArray.length > 0 && (callInitFrom404 = !0, $(".pagenotfound .not-found .searchinput").val(pathArray[0].replace(/-/g, " ")).focus().trigger("keyup"))
    }
}


if ($("body").hasClass("chapter-detail") && ("undefined" != typeof Storage && (chapterId = parseInt($(".chapter-id").data("id")))))
    if (void 0 !== localStorage["visited-chapters"]) {
        if (-1 == (items = JSON.parse(localStorage["visited-chapters"])).indexOf(chapterId)) {
            if (items.push(chapterId), items.length > 3e3)
                for (var i = 0; i < 2e3; i++) items.shift();
            localStorage["visited-chapters"] = JSON.stringify(items)
        }
    } else(item = []).push(chapterId), localStorage["visited-chapters"] = JSON.stringify(item);
var elementScrollToFixed, chapterId, isMobile = {
        Android: function() {
            return navigator.userAgent.match(/Android/i)
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i)
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i)
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i)
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i)
        },
        any: function() {
            return isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows()
        }
    },
    isMobileDevice = isMobile.any();

function InitAccountMenu() {
    $(".nav-account>li").hover(function() {
        $(this).addClass("open")
    }, function() {
        $(this).removeClass("open")
    }), isMobileDevice && $(".nav-account>li.dropdown>a").click(function() {
        return InitDropdownMenuOnMobile(this), !1
    })
}

function InitDropdownMenuOnMobile(e) {
    $(e).parent().hasClass("open") ? $("li.dropdown.open").removeClass("open") : ($("li.dropdown.open").removeClass("open"), $(e).parent().addClass("open"))
}
$(".navbar-nav>li").hover(function() {
    $(".navbar-nav > li.active").removeClass("active").addClass("curr"), $(this).addClass("open")
}, function() {
    $(".navbar-nav > li.curr").removeClass("curr").addClass("active"), $(this).removeClass("open")
}), isMobileDevice && $(".main-menu>li.dropdown>a").click(function() {
    return InitDropdownMenuOnMobile(this), !1
}), $(".nav-tabs li a").click(function() {
    return $(".nav-tabs li").removeClass("active"), $(".tab-content .tab-pane").removeClass("active").removeClass("in"), $(this).parent().addClass("active"), $($(this).attr("href")).addClass("active").addClass("in"), !1
}), InitAccountMenu(), $(".megamenu ul li a").hover(function() {
    $(".megamenu p").addClass("separator").text($(this).attr("data-title"))
}, function() {
    $(".megamenu p").removeClass("separator").text("")
}), $(".navbar-toggle").click(function() {
    $("body").hasClass("menu-open") ? ($("body").removeClass("menu-open"), $(this).find(".fa").removeClass("fa-times").addClass("fa-bars")) : ($("body").addClass("menu-open"), $(this).find(".fa").removeClass("fa-bars").addClass("fa-times"))
}), $(".search-button-icon").click(function() {
    $(".navbar-toggle").trigger("click"), $(".navbar-collapse .searchinput").focus()
}), $(".navbar-collapse .searchinput").focus(function() {
    window.scrollTo(0, 0)
}), isMobileDevice && $(".facebook-like .tip").addClass("hidden");
try {
    if (top.location.hostname != self.location.hostname) throw 1
} catch (e) {
    top.location.href = self.location.href
}
if ($(".items-slide").length) {
    var owl = $(".items-slide .owl-carousel");
    owl.owlCarousel({
        lazyLoad: !0,
        autoPlay: 5e3,
        stopOnHover: !0,
        slideSpeed: 300,
        paginationSpeed: 800,
        itemsCustom: [
            [0, 1],
            [360, 2],
            [480, 3],
            [768, 4],
            [992, 5]
        ]
    }), $(".items-slide .next").click(function() {
        return owl.trigger("owl.next"), !1
    }), $(".items-slide .prev").click(function() {
        return owl.trigger("owl.prev"), !1
    })
}

function loadTooltip() {
    $(".jtip").hover(function() {
        var e = $($(this).data("jtip"));
        if (!e.length) return !1;
        e.find(".box_img img").attr("src", e.find(".box_img img").attr("data-original")), $('<div id="cluetip"></div>').html(e.html()).appendTo("body").fadeIn("300")
    }, function() {
        $("#cluetip").remove()
    }).mousemove(function(e) {
        var t = e.pageX + 20,
            i = e.pageY + 10;
        $("#cluetip").css({
            top: i,
            left: t
        })
    })
}
if (initLazyload(), isMobileDevice || loadTooltip(), $(".star").length && $(".star").raty({
        path: "http://st." + hostName + "/Data/Sites/1/skins/comic/images/",
        score: function() {
            return $(this).attr("data-rating")
        },
        half: !0,
        readOnly: "false" == $(".star").attr("data-allowrating"),
        click: function(e, t) {
            var i = {
                comicId: $(this).attr("data-id"),
                rate: parseInt(e)
            };
            $.ajax({
                type: "POST",
                url: "/Comic/Services/ComicService.asmx/RatingComic",
                data: i,
                success: function(e) {
                    0 == e.success && alert(e.response)
                },
                error: function(e, t, i) {
                    AjaxHelper.processAjaxError(i)
                }
            })
        }
    }), (elementScrollToFixed = $("body").hasClass("chapter-detail") ? $(".chapter-nav") : wWidth >= 768 ? $(".main-nav") : $(".header")).scrollToFixed({
        preFixed: function() {
            $(".floatads").addClass("scroll-to-fixed-fixed")
        },
        preUnfixed: function() {
            $(".floatads").removeClass("scroll-to-fixed-fixed")
        }
    }), isMobileDevice) {
    var didScroll, lastScrollTop = 0,
        delta = 5;
    $(window).scroll(function(e) {
        didScroll = !0
    }), setInterval(function() {
        if (didScroll) {
            var e = $(this).scrollTop();
            if (Math.abs(lastScrollTop - e) <= delta) return;
            e > 100 ? e > lastScrollTop ? $(".scroll-to-fixed-fixed").removeClass("scroll-up").addClass("scroll-down") : $(".scroll-to-fixed-fixed").removeClass("scroll-down").addClass("scroll-up") : $(".scroll-to-fixed-fixed").removeClass("scroll-down"), lastScrollTop = e, didScroll = !1
        }
    }, 0)
}

function ProcessAmpReferral() {
    var e = location.hash.substr(1);
    if (null != e && e.indexOf("page_") >= 0) {
        var t = parseInt(e.replace("page_", ""));
        if (0 == isNaN(t) && t > 0) {
            var i = 0;
            t >= 2 && (i = t - 1);
            for (var a = 1; a <= i; a++) $("#page_" + a + " img").attr("src", "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"), $("#page_" + a).addClass("page-hidden").hide();
            i > 0 && (i > 5 ? ($('<div class="text-center mrb10 show-images hidden"><a class="btn btn-success">Xem ' + (i - 3) + ' ảnh còn lại <i class="fa fa-search-plus"></i></a></div>').insertAfter($("#page_1")), $('<div class="text-center mrb10 show-top-images"><a class="btn btn-success">Xem 3 ảnh trước <i class="fa fa-search-plus"></i></a></div>').insertAfter($("#page_" + i))) : $('<div class="text-center mrb10 show-images"><a class="btn btn-success">Xem ' + i + ' ảnh đang ẩn <i class="fa fa-search-plus"></i></a></div>').insertAfter($("#page_1")))
        }
    }
}($.fn.shorten = function(e) {
    var t = {
        maxHeight: 42,
        ellipsesText: "...",
        moreText: "Xem thêm <i class='fa fa-angle-right'></i>",
        lessText: "<i class='fa fa-angle-left'></i> Thu gọn"
    };
    return e && $.extend(t, e), $(document).off("click", ".morelink"), $(document).on({
        click: function() {
            var e = $(this);
            return e.hasClass("less") ? (e.removeClass("less"), e.html(t.moreText), e.prev().addClass("shortened")) : (e.addClass("less"), e.html(t.lessText), e.prev().removeClass("shortened")), !1
        }
    }, ".morelink"), this.each(function() {
        var e = $(this);
        e.hasClass("shortened") || e.height() > t.maxHeight && (e.addClass("shortened"), $('<a href="#" class="morelink">' + t.moreText + "</a>").insertAfter(e))
    })
}, $(".detail-content p").shorten(), ProcessAmpReferral(), $(".show-top-images a").click(function() {
    for (var e = 1, t = $(".page-hidden").length - 1; t >= 0 && !(e > 3); t--) {
        var i = $(".page-hidden img").eq(t);
        i.attr("src", i.attr("data-original")), i.parent().show().removeClass("page-hidden"), e += 1
    }
    return $(this).parent().remove(), $(".show-images").removeClass("hidden"), !1
}), $(".show-images a").click(function() {
    return $(".page-hidden img").each(function() {
        $(this).attr("src", $(this).attr("data-original")), $(this).parent().show().removeClass("page-hidden")
    }), $(this).parent().remove(), !1
}), $(".user-sidebar").click(function() {
    var e = $(this).find(".fa");
    e.hasClass("fa-angle-down") ? ($(".user-sidelink").addClass("hidden"), e.removeClass("active").removeClass("fa-angle-down").addClass("fa-angle-up")) : ($(".user-sidelink").removeClass("hidden"), e.addClass("active").removeClass("fa-angle-up").addClass("fa-angle-down"))
}), wWidth < 768 && $(".user-sidebar").trigger("click"), $(".list-chapter .view-more").click(function() {
    return $(".list-chapter ul li.less").addClass("active"), $(this).remove(), !1
}), $(".dropdown-genres").length && $(".dropdown-genres").insertAfter($(".comic-filter h1")), $(".advsearch-page .genre-item").click(function() {
    var e = $(this).find("span");
    e.hasClass("icon-checkbox") ? e.removeClass("icon-checkbox").addClass("icon-tick") : e.hasClass("icon-tick") ? e.removeClass("icon-tick").addClass("icon-cross") : e.removeClass("icon-cross").addClass("icon-checkbox")
}), $(".advsearch-page .btn-collapse").click(function() {
    $(this).find(".show-text").toggleClass("hidden"), $(this).find(".hide-text").toggleClass("hidden"), $(this).find(".fa").toggleClass("fa-angle-double-down").toggleClass("fa-angle-double-up"), $(".advsearch-form").toggleClass("hidden")
}), $(".advsearch-page .btn-search").click(function() {
    var e = $(".btn-reset").attr("href"),
        t = "",
        i = "",
        a = "",
        n = "";
    $.each($(".genre-item span"), function(e, o) {
        $(o).hasClass("icon-tick") ? (t += a + $(o).attr("data-id"), a = ",") : $(o).hasClass("icon-cross") && (i += n + $(o).attr("data-id"), n = ",")
    }), location.href = e + "?genres=" + t + "&notgenres=" + i + "&gender=" + $(".select-gender").val() + "&status=" + $(".select-status").val() + "&minchapter=" + $(".select-minchapter").val() + "&sort=" + $(".select-sort").val()
}), $(".chapter a").length) && ("undefined" != typeof Storage && void 0 !== localStorage["visited-chapters"] && (items = JSON.parse(localStorage["visited-chapters"])).forEach(function(e) {
    $('.chapter a[href$="/' + e + '"]').addClass("visited")
}));
if ($("body").hasClass("chapter-detail")) {
    if ("undefined" != typeof Storage && (chapterId = parseInt($(".chapter-id").data("id")))) {
        if (void 0 !== localStorage["visited-chapters"]) {
            if (-1 == (items = JSON.parse(localStorage["visited-chapters"])).indexOf(chapterId)) {
                if (items.push(chapterId), items.length > 2e3)
                    for (i = 0; i < 1500; i++) items.shift();
                localStorage["visited-chapters"] = JSON.stringify(items)
            }
        } else(item = []).push(chapterId), localStorage["visited-chapters"] = JSON.stringify(item);
        var comicLink = $(".breadcrumb li").eq(2).find("a"),
            chapterLink = $(".breadcrumb li").eq(3).find("a"),
            imageUrl = $('meta[itemprop="image"]').attr("content");
        if (comicLink && chapterLink && imageUrl) {
            var id = journalOptions.comicId,
                comic = {
                    id: id,
                    image: imageUrl,
                    name: comicLink.find("span").html(),
                    url: comicLink.attr("href"),
                    chapterName: chapterLink.find("span").html(),
                    chapterUrl: chapterLink.attr("href")
                };
            if (void 0 !== localStorage["visited-comics"]) {
                var index = (items = JSON.parse(localStorage["visited-comics"])).map(function(e) {
                    return e.id
                }).indexOf(id);
                if (index > -1 && items.splice(index, 1), items.push(comic), items.length > 96)
                    for (i = 96; i < items.length; i++) items.shift();
                localStorage["visited-comics"] = JSON.stringify(items)
            } else {
                (item = []).push(comic), localStorage["visited-comics"] = JSON.stringify(item)
            }
        }
    }
} else if ($("body").hasClass("comic-detail") && !$(".read-continue").length) {
    var items;
    if ("undefined" != typeof Storage)
        if (void 0 !== localStorage["visited-comics"])
            if ((items = JSON.parse(localStorage["visited-comics"])).length > 0)
                for (i = items.length - 1; i >= 0; i--)
                    if (items[i].id == journalOptions.comicId) {
                        var readHtml = $("<a>").html('Đọc tiếp <i class="fa fa-angle-right"></i>').attr("class", "read-continue btn btn-danger mrb5").attr("href", items[i].chapterUrl);
                        $(".read-action").append(readHtml);
                        break
                    }
}


function reCrawler() {
    ajaxComicPost("ReCrawlerChapter", refreshCallback, {
        chapterId: $(".chapter-id").attr("data-id")
    })
}

function fixChapter() {
    ajaxComicPost("FixChapter", refreshCallback, {
        chapterId: $(".chapter-id").attr("data-id")
    })
}

function deleteChapterPage(e) {
    ajaxComicPost("DeleteChapterPage", deleteChapterPageCallback, {
        chapterId: $(".chapter-id").attr("data-id"),
        index: $(e).parent().index(".page-chapter")
    })
}

function deleteChapterPageCallback(e) {
    $(".page-chapter").eq(e.index).slideUp(function() {
        $(this).remove()
    })
}

function refreshCallback(e) {
    1 == e.success && location.reload()
}

function ajaxComicPost(e, t, i) {
    0 == AjaxHelper.loadWaiting && (AjaxHelper.setLoadWaiting(!0), $.ajax({
        type: "POST",
        url: "/Comic/Services/ComicService.asmx/" + e,
        data: i,
        success: function(e) {
            void 0 !== t && t(e)
        },
        complete: function(e) {
            AjaxHelper.setLoadWaiting(!1)
        },
        error: function(e, t, i) {
            AjaxHelper.processAjaxError(i)
        }
    }))
}

function initLazyload() {
    $("img.lazy").lazyload({
        effect: "fadeIn",
        effectspeed: 300,
        failure_limit: 999,
        threshold: 50
    })
}

function getUserGuid() {
    return globalOpts.userGuid ? globalOpts.userGuid : null
}

function replaceUrl(e) {
    return e
}
$(".floatads .title").click(function() {
    $(this).parent().remove()
}), $(".floatads").length && wWidth < 1290 && ($(".leftbanner").remove(), $(".rightbanner").addClass("hidden"));
var followedOnChapter = !1;

function processComicLoader(e) {
    var t = journalOptions.comicId;
    if (0 == e) {
        var i = -1,
            a = window.location.hash.split("#cmt-");
        0 == isNaN(parseInt(a[1])) && parseInt(a[1]) > 0 && (i = parseInt(a[1]));
        var n = {
            comicId: t,
            commentId: i
        };
        i > 0 && $.ajax({
            type: "POST",
            url: "/Comic/Services/ComicService.asmx/ProcessComicLoader",
            data: n,
            success: function(e) {
                e.success && (e.commentCount && $(".comment-count").text(e.commentCount), e.commentsHtml && ($(".journalItems").html(e.commentsHtml), e.pagerHtml && ($(".sort-comment").parent().removeClass("hidden"), $(".commentpager").html(e.pagerHtml)), pluginInit(), shortenCommentText()), e.followedListHtml && ($(".comics-followed-block").html(e.followedListHtml), initLazyload()), e.followHtml && $(".follow").prepend(e.followHtml), e.readHtml && ($(".read-continue").length ? $(".read-continue").attr("href", $(e.readHtml).attr("href")) : $(".read-action").append(e.readHtml)), e.markAsReadHtml && $(".list-chapter h2.list-title").append(e.markAsReadHtml), e.readChapters && e.readChapters.length > 0 && $(".list-chapter .chapter a").each(function() {
                    // $.inArray($(this).attr("data-id"), e.readChapters) > -1 && $(this).addClass("visited")
                }), e.commentReplyHtml && ($("body").addClass("modal-open").append(e.commentReplyHtml), pluginInit(), shortenCommentText()))
            }
        })
    }
    $.ajax({
        type: "GET",
        url: siteRoot + "/Comic/Services/ComicService.asmx/GetFollowedButtonComic",
        data: {
            comicId: t,
            userGuid: getUserGuid(),
            token: globalOpts.userKey ? globalOpts.userKey : ""
        },
        success: function(t) {
            t.success && (1 == t.isFollowed && (followedOnChapter = !0), t.followHtml && (1 == e ? $(".chapter-nav").append(t.followHtml) : $(".follow").prepend(t.followHtml)), t.readHtml && ($(".read-continue").length ? $(".read-continue").attr("href", $(t.readHtml).attr("href")) : $(".read-action").append(replaceUrl(t.readHtml))), t.markAsReadHtml && $(".list-chapter h2.list-title").append(t.markAsReadHtml), t.readChapters && t.readChapters.length > 0 && $(".list-chapter .chapter a").each(function() {
                // $.inArray($(this).attr("data-id"), t.readChapters) > -1 && $(this).addClass("visited")
            }))
        },
        error: function(e, t, i) {
            console.log(i)
        }
    })
}

function setupLazyLoad(e) {
    var t = [];
    if ([].forEach.call(document.querySelectorAll(e), function(e, i) {
            t.push(e)
        }), t.length > 0) {
        if (function() {
                "use strict";
                if ("object" == typeof window)
                    if ("IntersectionObserver" in window && "IntersectionObserverEntry" in window && "intersectionRatio" in window.IntersectionObserverEntry.prototype) "isIntersecting" in window.IntersectionObserverEntry.prototype || Object.defineProperty(window.IntersectionObserverEntry.prototype, "isIntersecting", {
                        get: function() {
                            return this.intersectionRatio > 0
                        }
                    });
                    else {
                        var e = window.document,
                            t = [],
                            i = null,
                            a = null;
                        o.prototype.THROTTLE_TIMEOUT = 100, o.prototype.POLL_INTERVAL = null, o.prototype.USE_MUTATION_OBSERVER = !0, o._setupCrossOriginUpdater = function() {
                            return i || (i = function(e, i) {
                                a = e && i ? d(e, i) : {
                                    top: 0,
                                    bottom: 0,
                                    left: 0,
                                    right: 0,
                                    width: 0,
                                    height: 0
                                }, t.forEach(function(e) {
                                    e._checkForIntersections()
                                })
                            }), i
                        }, o._resetCrossOriginUpdater = function() {
                            i = null, a = null
                        }, o.prototype.observe = function(e) {
                            if (!this._observationTargets.some(function(t) {
                                    return t.element == e
                                })) {
                                if (!e || 1 != e.nodeType) throw new Error("target must be an Element");
                                this._registerInstance(), this._observationTargets.push({
                                    element: e,
                                    entry: null
                                }), this._monitorIntersections(e.ownerDocument), this._checkForIntersections()
                            }
                        }, o.prototype.unobserve = function(e) {
                            this._observationTargets = this._observationTargets.filter(function(t) {
                                return t.element != e
                            }), this._unmonitorIntersections(e.ownerDocument), 0 == this._observationTargets.length && this._unregisterInstance()
                        }, o.prototype.disconnect = function() {
                            this._observationTargets = [], this._unmonitorAllIntersections(), this._unregisterInstance()
                        }, o.prototype.takeRecords = function() {
                            var e = this._queuedEntries.slice();
                            return this._queuedEntries = [], e
                        }, o.prototype._initThresholds = function(e) {
                            var t = e || [0];
                            return Array.isArray(t) || (t = [t]), t.sort().filter(function(e, t, i) {
                                if ("number" != typeof e || isNaN(e) || e < 0 || e > 1) throw new Error("threshold must be a number between 0 and 1 inclusively");
                                return e !== i[t - 1]
                            })
                        }, o.prototype._parseRootMargin = function(e) {
                            var t = (e || "0px").split(/\s+/).map(function(e) {
                                var t = /^(-?\d*\.?\d+)(px|%)$/.exec(e);
                                if (!t) throw new Error("rootMargin must be specified in pixels or percent");
                                return {
                                    value: parseFloat(t[1]),
                                    unit: t[2]
                                }
                            });
                            return t[1] = t[1] || t[0], t[2] = t[2] || t[0], t[3] = t[3] || t[1], t
                        }, o.prototype._monitorIntersections = function(t) {
                            var i = t.defaultView;
                            if (i && -1 == this._monitoringDocuments.indexOf(t)) {
                                var a = this._checkForIntersections,
                                    n = null,
                                    o = null;
                                if (this.POLL_INTERVAL ? n = i.setInterval(a, this.POLL_INTERVAL) : (r(i, "resize", a, !0), r(t, "scroll", a, !0), this.USE_MUTATION_OBSERVER && "MutationObserver" in i && (o = new i.MutationObserver(a)).observe(t, {
                                        attributes: !0,
                                        childList: !0,
                                        characterData: !0,
                                        subtree: !0
                                    })), this._monitoringDocuments.push(t), this._monitoringUnsubscribes.push(function() {
                                        var e = t.defaultView;
                                        e && (n && e.clearInterval(n), s(e, "resize", a, !0)), s(t, "scroll", a, !0), o && o.disconnect()
                                    }), t != (this.root && this.root.ownerDocument || e)) {
                                    var c = u(t);
                                    c && this._monitorIntersections(c.ownerDocument)
                                }
                            }
                        }, o.prototype._unmonitorIntersections = function(t) {
                            var i = this._monitoringDocuments.indexOf(t);
                            if (-1 != i) {
                                var a = this.root && this.root.ownerDocument || e;
                                if (!this._observationTargets.some(function(e) {
                                        var i = e.element.ownerDocument;
                                        if (i == t) return !0;
                                        for (; i && i != a;) {
                                            var n = u(i);
                                            if ((i = n && n.ownerDocument) == t) return !0
                                        }
                                        return !1
                                    })) {
                                    var n = this._monitoringUnsubscribes[i];
                                    if (this._monitoringDocuments.splice(i, 1), this._monitoringUnsubscribes.splice(i, 1), n(), t != a) {
                                        var o = u(t);
                                        o && this._unmonitorIntersections(o.ownerDocument)
                                    }
                                }
                            }
                        }, o.prototype._unmonitorAllIntersections = function() {
                            var e = this._monitoringUnsubscribes.slice(0);
                            this._monitoringDocuments.length = 0, this._monitoringUnsubscribes.length = 0;
                            for (var t = 0; t < e.length; t++) e[t]()
                        }, o.prototype._checkForIntersections = function() {
                            if (this.root || !i || a) {
                                var e = this._rootIsInDom(),
                                    t = e ? this._getRootRect() : {
                                        top: 0,
                                        bottom: 0,
                                        left: 0,
                                        right: 0,
                                        width: 0,
                                        height: 0
                                    };
                                this._observationTargets.forEach(function(a) {
                                    var o = a.element,
                                        r = c(o),
                                        s = this._rootContainsTarget(o),
                                        l = a.entry,
                                        d = e && s && this._computeTargetAndRootIntersection(o, r, t),
                                        h = a.entry = new n({
                                            time: window.performance && performance.now && performance.now(),
                                            target: o,
                                            boundingClientRect: r,
                                            rootBounds: i && !this.root ? null : t,
                                            intersectionRect: d
                                        });
                                    l ? e && s ? this._hasCrossedThreshold(l, h) && this._queuedEntries.push(h) : l && l.isIntersecting && this._queuedEntries.push(h) : this._queuedEntries.push(h)
                                }, this), this._queuedEntries.length && this._callback(this.takeRecords(), this)
                            }
                        }, o.prototype._computeTargetAndRootIntersection = function(t, n, o) {
                            if ("none" != window.getComputedStyle(t).display) {
                                for (var r, s, l, h, u, m, f, g, v = n, $ = p(t), b = !1; !b && $;) {
                                    var C = null,
                                        w = 1 == $.nodeType ? window.getComputedStyle($) : {};
                                    if ("none" == w.display) return null;
                                    if ($ == this.root || 9 == $.nodeType)
                                        if (b = !0, $ == this.root || $ == e) i && !this.root ? !a || 0 == a.width && 0 == a.height ? ($ = null, C = null, v = null) : C = a : C = o;
                                        else {
                                            var y = p($),
                                                x = y && c(y),
                                                S = y && this._computeTargetAndRootIntersection(y, x, o);
                                            x && S ? ($ = y, C = d(x, S)) : ($ = null, v = null)
                                        }
                                    else {
                                        var k = $.ownerDocument;
                                        $ != k.body && $ != k.documentElement && "visible" != w.overflow && (C = c($))
                                    }
                                    if (C && (r = C, s = v, void 0, void 0, void 0, void 0, void 0, void 0, l = Math.max(r.top, s.top), h = Math.min(r.bottom, s.bottom), u = Math.max(r.left, s.left), g = h - l, v = (f = (m = Math.min(r.right, s.right)) - u) >= 0 && g >= 0 && {
                                            top: l,
                                            bottom: h,
                                            left: u,
                                            right: m,
                                            width: f,
                                            height: g
                                        } || null), !v) break;
                                    $ = $ && p($)
                                }
                                return v
                            }
                        }, o.prototype._getRootRect = function() {
                            var t;
                            if (this.root) t = c(this.root);
                            else {
                                var i = e.documentElement,
                                    a = e.body;
                                t = {
                                    top: 0,
                                    left: 0,
                                    right: i.clientWidth || a.clientWidth,
                                    width: i.clientWidth || a.clientWidth,
                                    bottom: i.clientHeight || a.clientHeight,
                                    height: i.clientHeight || a.clientHeight
                                }
                            }
                            return this._expandRectByRootMargin(t)
                        }, o.prototype._expandRectByRootMargin = function(e) {
                            var t = this._rootMarginValues.map(function(t, i) {
                                    return "px" == t.unit ? t.value : t.value * (i % 2 ? e.width : e.height) / 100
                                }),
                                i = {
                                    top: e.top - t[0],
                                    right: e.right + t[1],
                                    bottom: e.bottom + t[2],
                                    left: e.left - t[3]
                                };
                            return i.width = i.right - i.left, i.height = i.bottom - i.top, i
                        }, o.prototype._hasCrossedThreshold = function(e, t) {
                            var i = e && e.isIntersecting ? e.intersectionRatio || 0 : -1,
                                a = t.isIntersecting ? t.intersectionRatio || 0 : -1;
                            if (i !== a)
                                for (var n = 0; n < this.thresholds.length; n++) {
                                    var o = this.thresholds[n];
                                    if (o == i || o == a || o < i != o < a) return !0
                                }
                        }, o.prototype._rootIsInDom = function() {
                            return !this.root || h(e, this.root)
                        }, o.prototype._rootContainsTarget = function(t) {
                            return h(this.root || e, t) && (!this.root || this.root.ownerDocument == t.ownerDocument)
                        }, o.prototype._registerInstance = function() {
                            t.indexOf(this) < 0 && t.push(this)
                        }, o.prototype._unregisterInstance = function() {
                            var e = t.indexOf(this); - 1 != e && t.splice(e, 1)
                        }, window.IntersectionObserver = o, window.IntersectionObserverEntry = n
                    }
                function n(e) {
                    this.time = e.time, this.target = e.target, this.rootBounds = l(e.rootBounds), this.boundingClientRect = l(e.boundingClientRect), this.intersectionRect = l(e.intersectionRect || {
                        top: 0,
                        bottom: 0,
                        left: 0,
                        right: 0,
                        width: 0,
                        height: 0
                    }), this.isIntersecting = !!e.intersectionRect;
                    var t = this.boundingClientRect,
                        i = t.width * t.height,
                        a = this.intersectionRect,
                        n = a.width * a.height;
                    this.intersectionRatio = i ? Number((n / i).toFixed(4)) : this.isIntersecting ? 1 : 0
                }

                function o(e, t) {
                    var i, a, n, o = t || {};
                    if ("function" != typeof e) throw new Error("callback must be a function");
                    if (o.root && 1 != o.root.nodeType) throw new Error("root must be an Element");
                    this._checkForIntersections = (i = this._checkForIntersections.bind(this), a = this.THROTTLE_TIMEOUT, n = null, function() {
                        n || (n = setTimeout(function() {
                            i(), n = null
                        }, a))
                    }), this._callback = e, this._observationTargets = [], this._queuedEntries = [], this._rootMarginValues = this._parseRootMargin(o.rootMargin), this.thresholds = this._initThresholds(o.threshold), this.root = o.root || null, this.rootMargin = this._rootMarginValues.map(function(e) {
                        return e.value + e.unit
                    }).join(" "), this._monitoringDocuments = [], this._monitoringUnsubscribes = []
                }

                function r(e, t, i, a) {
                    "function" == typeof e.addEventListener ? e.addEventListener(t, i, a || !1) : "function" == typeof e.attachEvent && e.attachEvent("on" + t, i)
                }

                function s(e, t, i, a) {
                    "function" == typeof e.removeEventListener ? e.removeEventListener(t, i, a || !1) : "function" == typeof e.detatchEvent && e.detatchEvent("on" + t, i)
                }

                function c(e) {
                    var t;
                    try {
                        t = e.getBoundingClientRect()
                    } catch (e) {}
                    return t ? (t.width && t.height || (t = {
                        top: t.top,
                        right: t.right,
                        bottom: t.bottom,
                        left: t.left,
                        width: t.right - t.left,
                        height: t.bottom - t.top
                    }), t) : {
                        top: 0,
                        bottom: 0,
                        left: 0,
                        right: 0,
                        width: 0,
                        height: 0
                    }
                }

                function l(e) {
                    return !e || "x" in e ? e : {
                        top: e.top,
                        y: e.top,
                        bottom: e.bottom,
                        left: e.left,
                        x: e.left,
                        right: e.right,
                        width: e.width,
                        height: e.height
                    }
                }

                function d(e, t) {
                    var i = t.top - e.top,
                        a = t.left - e.left;
                    return {
                        top: i,
                        left: a,
                        height: t.height,
                        width: t.width,
                        bottom: i + t.height,
                        right: a + t.width
                    }
                }

                function h(e, t) {
                    for (var i = t; i;) {
                        if (i == e) return !0;
                        i = p(i)
                    }
                    return !1
                }

                function p(t) {
                    var i = t.parentNode;
                    return 9 == t.nodeType && t != e ? u(t) : i && 11 == i.nodeType && i.host ? i.host : i && i.assignedSlot ? i.assignedSlot.parentNode : i
                }

                function u(e) {
                    try {
                        return e.defaultView && e.defaultView.frameElement || null
                    } catch (e) {
                        return null
                    }
                }
            }(), "IntersectionObserver" in window) {
            var i = new IntersectionObserver(function(e, t) {
                e.forEach(function(e) {
                    e.intersectionRatio > 0 && (c(e.target), t.unobserve(e.target))
                })
            }, {
                rootMargin: "200px 0px 200px 0px",
                threshold: 0
            });
            t.forEach(function(e) {
                i.observe(e)
            })
        } else {
            var a = !1,
                n = function() {
                    !1 === a && (a = !0, setTimeout(function() {
                        t.forEach(function(e) {
                            e.getBoundingClientRect().top - 200 <= window.innerHeight && e.getBoundingClientRect().bottom + 200 >= 0 && "none" !== getComputedStyle(e).display && (c(e), 0 === (t = t.filter(function(t) {
                                return t !== e
                            })).length && (window.addEventListener ? (removeEventListener("scroll", n), removeEventListener("resize", n)) : window.attachEvent && (detachEvent("onscroll", n), detachEvent("onresize", n))))
                        }), a = !1
                    }, 200))
                };
            window.addEventListener ? (addEventListener("DOMContentLoaded", n, !1), addEventListener("load", n, !1), addEventListener("scroll", n, !1), addEventListener("resize", n, !1)) : window.attachEvent && (attachEvent("onDOMContentLoaded", n), attachEvent("onload", n), attachEvent("onscroll", n), attachEvent("onresize", n))
        }
        var o = !1,
            r = !1,
            s = !1;

        function c(t) {
            if (null != t) {
                var i = t.getAttribute("data-type");
                if (".comics-followed-block" == e) {
                    if (0 == r) null != (a = getUserGuid()) && $.ajax({
                        type: "GET",
                        url: siteRoot + "/Comic/Services/ComicService.asmx/GetFollowedBlockComics",
                        data: {
                            userGuid: a,
                            token: globalOpts.userKey ? globalOpts.userKey : ""
                        },
                        success: function(e) {
                            e.success && e.followedListHtml && ($(".comics-followed-block").html(replaceUrl(e.followedListHtml)), initLazyload())
                        }
                    }), r = !0
                } else if (".chapter-nav-bottom" == e) {
                    if (0 == s) {
                        var a = "",
                            n = "";
                        1 == followedOnChapter && (null == (a = getUserGuid()) && (a = ""), "" != a && globalOpts.userKey && (n = globalOpts.userKey)), $.ajax({
                            type: "POST",
                            url: siteRoot + "/Comic/Services/ComicService.asmx/ProcessChapterLoaded",
                            data: {
                                chapterId: $(".chapter-id").attr("data-id"),
                                userGuid: a,
                                token: n
                            },
                            success: function(e) {}
                        }), s = !0
                    }
                } else "facebook" == i && 0 == o && (window.fbAsyncInit = function() {
                    FB.init({
                        appId: "745819368841087",
                        status: !1,
                        cookie: !0,
                        version: "v2.0",
                        xfbml: !0,
                        oauth: !0
                    })
                }, c = document, l = "script", d = "facebook-jssdk", p = c.getElementsByTagName(l)[0], c.getElementById(d) || ((h = c.createElement(l)).id = d, h.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=745819368841087&version=v2.7", p.parentNode.insertBefore(h, p)), o = !0)
            }
            var c, l, d, h, p
        }
    }
}
